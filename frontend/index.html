<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flood Data Mining - Search & Analyze</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1>🌊 Flood Data Mining</h1>
        
        <div class="search-section">
            <form id="searchForm">
                <input type="text" id="query" placeholder="Enter flood-related search terms..." required>
                <button type="submit">🔍 Search & Scrape</button>
            </form>
            <button id="generateQueriesBtn" class="generate-queries-btn">🔍 Generate Search Queries</button>
            
            <!-- Query Generation Form -->
            <div class="query-generation" id="queryGeneration" style="display: none;">
                <div class="query-form">
                    <h3>🤖 AI Query Generation Agent</h3>
                    <p>Enter keywords and context to let our AI agent generate strategic search queries</p>
                    
                    <div class="form-row">
                        <label for="keywordsInput">Keywords (comma-separated):</label>
                        <input type="text" id="keywordsInput" placeholder="flood, lebanon, river, rain..." required>
                    </div>
                    
                    <div class="form-row">
                        <label for="contextInput">Context (optional):</label>
                        <textarea id="contextInput" placeholder="Provide additional context for the AI agent to generate more relevant and strategic queries..." rows="3"></textarea>
                    </div>
                    
                    <div class="form-row">
                        <label for="queryCount">Number of queries:</label>
                        <select id="queryCount">
                            <option value="5">5 queries</option>
                            <option value="10" selected>10 queries</option>
                            <option value="15">15 queries</option>
                            <option value="20">20 queries</option>
                            <option value="30">30 queries</option>
                            <option value="50">50 queries</option>
                            <option value="75">75 queries</option>
                            <option value="100">100 queries</option>
                        </select>
                    </div>
                    
                    <div class="form-row">
                        <label for="languagePreference">Language preference:</label>
                        <select id="languagePreference">
                            <option value="mixed">Mixed (Arabic + English)</option>
                            <option value="english">English only</option>
                            <option value="arabic">Arabic only</option>
                        </select>
                    </div>
                    
                    <div class="form-row">
                        <label for="modelSelection">AI Model:</label>
                        <select id="modelSelection">
                            <option value="gpt-oss:20b">gpt-oss:20b</option>
                        </select>
                    </div>
                    
                    <div class="form-buttons">
                        <button type="button" id="generateBtn" class="generate-btn">🚀 Generate Agent Queries</button>
                        <button type="button" id="cancelGenerateBtn" class="cancel-btn">❌ Cancel</button>
                    </div>
                </div>
                
                <!-- Generated Queries Display -->
                <div class="generated-queries" id="generatedQueries" style="display: none;">
                    <h3>📝 AI Agent Generated Search Queries</h3>
                    
                    <!-- Agent Reasoning Display -->
                    <div class="agent-reasoning" id="agentReasoning" style="display: none;">
                        <h4>🧠 Agent Reasoning</h4>
                        <div class="reasoning-content" id="reasoningContent"></div>
                    </div>
                    
                    <!-- Query Strategies Display -->
                    <div class="query-strategies" id="queryStrategiesDisplay" style="display: none;">
                        <h4>🎯 Query Strategies</h4>
                        <div class="strategies-list" id="strategiesList"></div>
                    </div>
                    
                    <!-- Search Focus Areas -->
                    <div class="search-focus" id="searchFocusDisplay" style="display: none;">
                        <h4>🔍 Search Focus Areas</h4>
                        <div class="focus-list" id="focusList"></div>
                    </div>
                    
                    <!-- Generated Queries List -->
                    <div class="queries-container">
                        <div class="queries-stats" id="queriesStats"></div>
                        <div class="queries-list" id="queriesList"></div>
                    </div>
                    
                    <div class="queries-actions">
                        <button type="button" id="copyQueriesBtn" class="copy-btn">📋 Copy All Queries</button>
                        <button type="button" id="copyStrategiesBtn" class="copy-strategies-btn">📋 Copy Strategies</button>
                        <button type="button" id="newGenerationBtn" class="new-generation-btn">🔄 Generate New</button>
                    </div>
                </div>
            </div>
            
            <!-- Enhanced Loading Indicators -->
            <div class="loading-container">
                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <div class="loading-text">
                        <div class="loading-title">Searching and scraping articles...</div>
                        <div class="loading-subtitle" id="loadingSubtitle">Fetching search results...</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                    </div>
                </div>
                <div class="loading" id="analyzingLoading">
                    <div class="spinner"></div>
                    <div class="loading-text">Analyzing articles with AI...</div>
                </div>
                <div class="loading" id="flaggedLoading">
                    <div class="spinner"></div>
                    <div class="loading-text">Loading flagged articles from database...</div>
                </div>
            </div>
        </div>

        <div class="results-section">
            <div class="results-header">
                <div class="results-count" id="resultsCount"></div>
            </div>
            <ul id="results"></ul>
            <div class="empty-state" id="emptyState">
                <div class="empty-icon">🔍</div>
                <h3>Search for flood data</h3>
                <p>Enter keywords to find relevant flood information and news</p>
            </div>
        </div>
    </div>
    
    <!-- Include the JavaScript file -->
    <script src="script.js"></script>
</body>
</html>